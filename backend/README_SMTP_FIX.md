# SMTP 連線超時問題 - 快速解決指南

## 🔴 問題
錯誤訊息：`SMTP 連線超時:無法連線到郵件伺服器`

## ✅ 快速解決方案

### 方法 1：允許防火牆連線（最簡單）

#### 選項 A：使用 PowerShell 腳本（推薦）
1. 右鍵點擊 `fix_smtp_firewall.ps1`
2. 選擇「以系統管理員身份執行」
3. 腳本會自動設定防火牆規則

#### 選項 B：手動設定
1. 開啟「Windows Defender 防火牆」
2. 點擊「進階設定」
3. 選擇「輸出規則」→「新增規則」
4. 選擇「程式」→ 找到 Python.exe
5. 選擇「允許連線」
6. 完成

### 方法 2：允許 SMTP 連接埠

1. 開啟「Windows Defender 防火牆」
2. 點擊「進階設定」
3. 選擇「輸出規則」→「新增規則」
4. 選擇「連接埠」→「TCP」→「特定本機連接埠」→ 輸入 `587`
5. 選擇「允許連線」
6. 完成

### 方法 3：使用手機熱點測試

如果使用公司/學校網路，可能被阻擋：
1. 開啟手機熱點
2. 電腦連接到手機熱點
3. 重新測試 Email 發送

### 方法 4：改用 Gmail API（最可靠）

如果 SMTP 持續有問題，建議改用 Gmail API：

1. 修改 `EMAIL.env`：
   ```env
   USE_SMTP="false"
   ```

2. 設定 Gmail API：
   - 前往 https://console.cloud.google.com/
   - 建立專案
   - 啟用 Gmail API
   - 建立 OAuth 2.0 憑證
   - 下載 credentials.json
   - 將檔案放在 `backend/` 目錄

## 🔍 診斷工具

執行以下命令測試網路連線：
```bash
python test_smtp_network.py
```

## 📝 測試結果說明

- ✅ 埠 25 可以連線 → 但 Gmail 不使用此埠
- ❌ 埠 587 無法連線 → 被防火牆阻擋（需要允許）
- ❌ 埠 465 無法連線 → 被防火牆阻擋（需要允許）

## 💡 建議

1. **優先嘗試**：方法 1（允許防火牆連線）
2. **如果還是不行**：方法 3（使用手機熱點測試）
3. **長期解決方案**：方法 4（改用 Gmail API）

## ❓ 需要幫助？

如果以上方法都無法解決，請提供：
1. 網路環境（家用/公司/學校）
2. 是否有使用 VPN
3. 防火牆設定截圖
4. 完整的錯誤訊息

